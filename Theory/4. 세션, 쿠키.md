# 세션, 쿠키
======

## 세션
  [세션(Session)]이란 웹 사이트의 여러 페이지에 걸쳐 사용되는 사용자 정보를 저장하는 방법을 의미
  
  사용자가 브라우저를 통해 웹 서버에 접속한 시점부터
  브라우저를 닫아 서버와의 연결을 끝내는 시점까지를 세션이라고 한다.

  - [세션,_쿠키를_사용하는_이유]
    HTTP 프로토콜의 비연결성(Connectionless)과 무상태성(Stateless)과 같은 특성을 가지기 떄문에
    서버는 클라이언트가 누구인지 매번 확인해야함 이러한 특성 보완을 위해 사용
  
  - [비연결성(Connectionless)]
    클라이언트가 요청을 한 후 응답을 받으면 그 연결을 끊어 버리는 특징
    클라이언트가 Request를 서버에 보내면, 서버는 클라이언트에게 요청에 맞는 Response를 보내고
    접속을 끊는 특성

  - [무상태성(Stateless)]
    통신이 끊나면 상태를 유지하지 않는 특징
    연결을 끊는 순간 클라이언트와 서버의 통신이 끝나며
    다음 통신에서 이전 상태를 유지하지 않는다.

## 쿠키
  [쿠키(Cookie)]란 클라이언트(브라우저) 로컬에 저장되는 키, 값으로 이루어진 데이터
  브라우저가 Request시 Request Header에 넣어 자동으로 서버에 전송 됨
  유효기간이 정해지면 브라우저가 종료되어도 데이터가 유지되는 특성이 있음

  - [세션_동작순서]
  1. 클라이언트가 페이지를 요청
  2. 서버는 접근한 클라이언트의 쿠키를 확인하여 클라이언트가
  해당 session-id를 보냈는지 확인
  3. session-id가 존재 하지 않으면 서버가 session-id를 생성해 클라이언트에게 돌려줌
  4. 서버에서 클라이언트로 돌려준 session-id를 쿠키를 사용해 로컬에 저장한다.
  5. 클라이언트는 매 요청 시 쿠키(session-id)를 서버에 전달

  - [세션_불일치]
  여러 서버가 각각 세션저장소를 독립적으로 갖기 때문에 세션 불일치가 발생할 수 있음

  - [해결방안]

  1. [스티키_세션]
  로드 밸런서를 이용 해 요청을 받으면 쿠키에 존재하는지 확인
  쿠키가 있으면 해당 요청이 키쿠에 지정된 서버로 전송
  쿠키가 없으면 로드 밸런서가 로드 밸런싱 알고리즘을 기반으로 서버를 선정

  단점 : 고정된 세션을 사용한다는 것은 특정 서버에 트래픽이 몰릴 위험이 있음
  또한 원래 세션에 장애가 생길경우 해당 세션에 정보를 잃어버려 가용성에 문제가 생길 수 있음
  
  2. [세션_클러스터링]
  하나의 세션 저장소에 변경되는 요소가 발생하면 변경사항이 다른 모든 세션에 복제 됨

  단점 : 세션에 데이터가 변경 될 때마다 모든 서버에 적용해야 하므로 트래픽 증가 등 성능 저하 발생 가능
  모든 서버가 동일한 세션 객체를 가져야 하므로 많은 저장공간 필요

  소규모 서버에 적합

  3. [세션_스토리지_분리]
  별도의 세션 저장소 활용, 모든 서버가 같은 세션 저장소를 활용
  
  해당 서버에 장애가 발생하면 모든 세션에 리스크가 생김
  동일한 별도의 세션 저장소 복제 필요

  ex. Redis, Memcached

  Reference :
  https://hyuntaeknote.tistory.com/6?category=867120